<?php

namespace Tests\Feature;

use Illuminate\Foundation\Testing\RefreshDatabase;
use Illuminate\Foundation\Testing\WithFaker;
use Tests\TestCase;
use Faker\Factory as Faker;
use Illuminate\Http\UploadedFile;

class Ac_SportEventsTest extends TestCase
{
    /**
     * A basic feature test example.
     *
     * @return void
     */
    private static $user;
    private static $sportevent;

    public static function setUpBeforeClass(): void
    {
        $faker = Faker::create();
        $password = $faker->regexify('[0-9]{1}[!]{1}[A-Z]{1}[a-z]{4}[A-Z]{1}');
        $user = [
            'firstName' => $faker->firstName(),
            'lastName' => $faker->lastName(),
            'email' => $faker->email(),
            'password' => $password,
            'repeatPassword' => $password
        ];
        self::$user = $user;

        $sportevent = [
            'eventDate' => $faker->date(),
            'eventType' => $faker->word(),
            'eventName' => $faker->word(),
            'organizerId' => $faker->image('image.jpg')
        ];
        self::$sportevent = $sportevent;

    }

    public function test_preparation()
    {
        $response = $this->post('/register',self::$user);
        $response->assertStatus(302)
        ->assertRedirect('/');
    }

    public static function tearDownAfterClass(): void
    {
        self::$user = [];
    }

    public function sign()
    {
        return $this->post('login',[
            'email' => self::$user['email'],
            'password' => self::$user['password']
        ]);
    }

    public function test_user_can_access_sport_events_page()
    {
        $response = $this->sign();

        $response = $this->get('/admin/v1/sport-events');
        $response->assertStatus(200)
        ->assertSee('No',false)
        ->assertSee('Event Date',false)
        ->assertSee('Event Name',false)
        ->assertSee('Event Type',false)
        ->assertSee('Organizer Name',false)
        ->assertSee('Action',false);
    }

    public function test_user_can_access_sport_event_create_form()
    {
        $response = $this->sign();

        $response = $this->get('/admin/v1/sport-events/create');
        $response->assertStatus(200)
        ->assertSee('Event Date',false)
        ->assertSee('Event Name',false)
        ->assertSee('Event Type',false)
        ->assertSee('Organizer',false)
        ->assertSee('Save',false);
    }

    public function test_user_can_add_organizer()
    {
        $response = $this->sign();

        $response = $this->post('/admin/v1/sport-events/store',self::$organizer);
        $response->assertStatus(302)
        ->assertRedirect('/admin/v1/organizer');
    }

    // public function test_user_can_edit_single_organizer()
    // {
    //     $response = $this->sign();

    //     $response = $this->get('/admin/v1/organizer/'.self::$organizer[''].'/store',self::$organizer);
    //     $response->assertStatus(302)
    //     ->assertRedirect('/admin/v1/organizer');
    // }
}
